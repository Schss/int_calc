name: CI and CD

on:
  pull_request:
    branches: [ master ]

jobs:
    CI:
      runs-on: ubuntu-latest
# some shity comment
      steps:
      - uses: actions/checkout@v2
      
      - name: Build all
        run: |
          mkdir logs
          cmake CMakeLists.txt -B"build"  &> logs/cmake.log
          cd build
          make -j8 &> ../logs/make.log
      - name: Upload logs
        uses: actions/upload-artifact@v1
        if: failure()
        with:
          name: Build logs
          path: logs

      - name: tests
        run: |
          ./build/tests &> logs/tests.log
      - name: Upload t-logs
        uses: actions/upload-artifact@v1
        #if: failure()
        with:
          name: tests logs
          path: logs/tests.log
